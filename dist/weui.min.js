+function(e){"use strict";function o(o){var t,n=e(this),s=(n.attr("href"),n.dataset());n.hasClass("open-popup")&&(t=s.popup?s.popup:".popup",e.popup(t)),n.hasClass("close-popup")&&(t=s.popup?s.popup:".popup.modal_in",e.closeModal(t,a.useCss3)),n.hasClass("close-offcanvas")&&e.closeModal(".weui_offcanvas.modal_in",a.useCss3),n.hasClass("weui_mask")&&(e(".modal.modal_in").length>0&&a.modalCloseByOutside&&e.closeModal(".modal.modal_in",a.useCss3),e(".weui_actionsheet.modal_in").length>0&&a.actionsCloseByMask&&e.closeModal(".weui_actionsheet.modal_in",a.useCss3)),n.hasClass("popup_overlay")&&(e(".popup.modal_in").length>0&&e.closeModal(".popup.modal_in",a.useCss3),e(".weui_offcanvas.modal_in").length>0&&a.offcanvasCloseByMask&&e.closeModal(".weui_offcanvas.modal_in",a.useCss3))}var t=document.createElement("div");e.modalStack=[],e.queueOffcanvas=[],e.dequeueOffcanvas=function(){return e.queueOffcanvas.shift()()},e.modalStackClearQueue=function(){e.modalStack.length&&e.modalStack.shift()()},e.modal=function(o){o=o||{};var n="",s="",l="undefined"!=typeof o.useCss3?o.useCss3:a.useCss3;if(o.buttons&&o.buttons.length>0)for(var i=0;i<o.buttons.length;i++)s+='<a class="weui_btn_dialog'+(o.buttons[i].close?" default":"")+'">'+o.buttons[i].text+"</a>";var d=o.extraClass||"",u='<div class="weui_dialog_hd"><strong class="weui_dialog_title">'+(o.title?o.title:"提示")+"</strong></div>",c=o.text?'<div class="weui_dialog_bd">'+o.text+"</div>":"",r=o.afterText?o.afterText:"",p=o.buttons&&0!==o.buttons.length?"":"modal-no-buttons",f=o.verticalButtons?"modal-buttons-vertical":"";n='<div class="weui_dialog weui_dialog_'+o.type+'"><div class="weui_dialog_inner '+d+" "+p+" "+o.type+'">'+(u+c+r)+'<div class="weui_dialog_ft '+f+'">'+s+"</div></div></div>",t.innerHTML=n;var v=e(t).children();return e(a.modalContainer).append(v[0]),v.find(".weui_dialog_ft .weui_btn_dialog").each(function(t,a){e(a).on("click",function(a){o.buttons[t].close!==!1&&e.closeModal(v,l),o.buttons[t].onClick&&o.buttons[t].onClick(v,a),o.onClick&&o.onClick(v,t)})}),e.openModal(v,l),v[0]},e.alert=function(o,t,n){return"function"==typeof t&&(n=arguments[1],t=void 0),e.modal({useCss3:!1,type:"alert",text:o||"",title:"undefined"==typeof t?a.modalTitle:t,buttons:[{text:a.modalButtonOk,onClick:n}]})},e.confirm=function(o,t,n,s){return"function"==typeof t&&(s=arguments[2],n=arguments[1],t=void 0),e.modal({useCss3:!1,type:"confirm",text:o||"",title:"undefined"==typeof t?a.modalTitle:t,buttons:[{text:a.modalButtonCancel,onClick:s,close:!0},{text:a.modalButtonOk,onClick:n}]})},e.prompt=function(o,t,n){return"function"==typeof o&&(n=arguments[2],t=arguments[1],o=void 0),e.modal({useCss3:!1,type:"prompt",title:"undefined"==typeof o?a.modalTitle:o,afterText:'<div class="weui_cells weui_cells_form">                <div class="weui_cell">                    <div class="weui_cell_bd weui_cell_primary">                        <textarea class="weui_textarea ipt-result" placeholder="请输入" rows="3"></textarea>                    </div>                </div>            </div>',buttons:[{text:a.modalButtonCancel,close:!0},{text:a.modalButtonOk}],onClick:function(o,a){0===a&&n&&n(e(o).find(".ipt-result").val()),1===a&&t&&t(e(o).find(".ipt-result").val())}})},e.loading=function(o){if(e(".weui_loading_toast")[0])return e(".weui_loading_toast").remove();var t=[];t.push('<div class="weui_loading_toast"><div class="weui_mask_transparent"></div>'),t.push('<div class="weui_toast"><div class="weui_loading">');for(var n=0;11>=n;n++)t.push('<div class="weui_loading_leaf weui_loading_leaf_'+n+'"></div>');t.push("</div>"),t.push('<p class="weui_toast_content">'+(o?o:"数据加载中")+"</p>"),t.push("</div></div>"),e(a.modalContainer).append(t.join(""))},e.actions=function(o){var n,s,l;o=o||[],o.length>0&&!e.isArray(o[0])&&(o=[o]);for(var i,d="",u=0;u<o.length;u++)for(var c=0;c<o[u].length;c++){0===c&&(d+='<div class="weui_actionsheet_menu">');var r=o[u][c],p=r.label?"weui_actionsheet_cell label":"weui_actionsheet_cell";r.bold&&(p+=" actions-modal-button-bold"),r.color&&(p+=" color-"+r.color),r.bg&&(p+=" bg-"+r.bg),r.disabled&&(p+=" disabled"),d+='<div class="'+p+'">'+r.text+"</div>",c===o[u].length-1&&(d+="</div>")}i='<div class="weui_actionsheet">'+d+"</div>",t.innerHTML=i,n=e(t).children(),e(a.modalContainer).append(n[0]),s=".weui_actionsheet_menu",l=".weui_actionsheet_cell";var f=n.find(s);return f.each(function(t,s){var i=t;e(s).children().each(function(t,s){var d,u=t,c=o[i][u];e(s).is(l)&&(d=e(s)),d&&d.on("click",function(o){c.close!==!1&&e.closeModal(n,a.useCss3),c.onClick&&c.onClick(n,o)})})}),e.openModal(n,a.useCss3),n[0]},e.popup=function(o){if("string"==typeof o&&o.indexOf("<")>=0){var t=document.createElement("div");if(t.innerHTML=o.trim(),!(t.childNodes.length>0))return!1;o=t.childNodes[0],e(a.modalContainer).append(o)}return o=e(o),0===o.length?!1:(!e(o).hasClass("popup")&&e(o).addClass("popup"),o.show(),e.openModal(o,a.useCss3),o[0])},e.toast=function(o,t,a){var n=[];n.push('<div class="toast"><div class="weui_mask_transparent"></div>'),t&&t.length?(n.push('<div class="weui_toast"><div class="weui_toast_icon">'+t+"</div>"),n.push('<p class="weui_toast_content">'+o+"</p></div></div>")):n.push('<div class="weui_toast onlytxt">'+o+"</div></div>");var s=e(n.join("")).appendTo(document.body);s.one("opened",function(){setTimeout(function(){e.closeModal(s,!0)},a||2e3)}),e.openModal(s,!0)},e.offcanvas=function(o,t,n){var s={useCss3:!0,content:"",position:t||"top",contentStyle:null,onOpenBefore:null,onOpenAfter:"function"==typeof n?n:null,onCloseBefore:null,onCloseAfter:null};"object"==typeof o?s=e.extend({},s,o):s.content=o;var l=s.content;if("string"==typeof l&&l.indexOf("<")>=0){var i=document.createElement("div");if(i.innerHTML=l.trim(),!(i.childNodes.length>0))return!1;l=i.childNodes[0],e(a.modalContainer).append(l)}var d=e(l);return!d.hasClass("weui_offcanvas")&&d.addClass("weui_offcanvas"),"function"==typeof s.onOpenBefore&&d.one("open",function(){s.onOpenBefore.call(this,d)}),"function"==typeof s.onOpenAfter&&d.one("opened",function(){s.onOpenAfter.call(this,d)}),"function"==typeof s.onCloseBefore&&d.one("close",function(){s.onCloseBefore.call(this,d)}),"function"==typeof s.onCloseAfter&&d.one("closed",function(){s.onCloseafter.call(this,d)}),e.openModal(l,s.useCss3,s)},e.openModal=function(o,t,n){o=e(o);var s=o.hasClass("modal"),l=!o.hasClass("toast"),i=!!n,d=o.hasClass("popup"),u=o.hasClass("toast");if(e(".modal.modal_in:not(.modal_out)").length&&a.modalStack&&s&&l)return void e.modalStack.push(function(){e.openModal(o,t)});if(e(".weui_offcanvas.modal_in:not(.modal_out)").length&&a.modalStack&&i){var c=e(".weui_offcanvas.modal_in");return e.queueOffcanvas.push(function(){e.openModal(o,t,n)}),void e.closeModal(c,t)}s&&(o.show(),o.css({marginTop:-Math.round(o.outerHeight()/2)+"px"})),u&&o.css({marginLeft:-Math.round(o.outerWidth()/2/1.185)+"px"}),i&&(n.position&&o.addClass(n.position),n.contentStyle&&o.css(n.contentStyle),o.show());var r;u||(0!==e(".weui_mask").length||d||i||e(a.modalContainer).append('<div class="weui_mask"></div>'),0===e(".popup_overlay").length&&(d||i)&&e(a.modalContainer).append('<div class="popup_overlay"></div>'),r=e(d||i?".popup_overlay":".weui_mask"));o[0].clientLeft;return o.trigger("open"),u||r.addClass("weui_mask_visible"),o.removeClass("modal_out").addClass("modal_in").transitionEnd(function(e){o.hasClass("modal_out")?o.trigger("closed"):o.trigger("opened")},t),"function"==typeof cb&&cb.call(this,o),!0},e.closeModal=function(o,t){if(o=e(o||".weui_dialog"),"undefined"==typeof o||0!==o.length){var n=o.hasClass("weui_dialog"),s=o.hasClass("popup"),l=o.hasClass("toast"),i=o.hasClass("weui_offcanvas"),d=e(s||i?".popup_overlay":".weui_mask");return i?!e.queueOffcanvas.length&&d.removeClass("weui_mask_visible"):s?o.length===e(".popup.modal_in").length&&d.removeClass("weui_mask_visible"):l||d.removeClass("weui_mask_visible"),o.trigger("close"),o.removeClass("modal_in").addClass("modal_out").transitionEnd(function(t){o.hasClass("modal_out")?o.trigger("closed"):o.trigger("opened"),s||i?(o.removeClass("modal_out").hide(),o.length>0&&o.remove()):o.remove(),i&&e.queueOffcanvas.length&&e.dequeueOffcanvas()},t),n&&a.modalStack&&e.modalStackClearQueue(),!0}},e(document).on("click",".weui_mask, .popup_overlay, .close-popup, .open-popup, .close-offcanvas",o);var a=e.modal.prototype.defaults={useCss3:!0,modalStack:!0,modalCloseByOutside:!1,actionsCloseByMask:!0,offcanvasCloseByMask:!0,modalButtonOk:"确定",modalButtonCancel:"取消",modalPreloaderTitle:"加载中",modalContainer:document.body?document.body:"body"}}(Zepto);